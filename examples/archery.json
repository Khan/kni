{
    "start": {
        "type": "set",
        "variable": "gold",
        "expression": [
            "val",
            2
        ],
        "next": "start.1"
    },
    "start.1": {
        "type": "set",
        "variable": "arrow",
        "expression": [
            "val",
            0
        ],
        "next": "start.2"
    },
    "start.2": {
        "type": "set",
        "variable": "hit",
        "expression": [
            "val",
            0
        ],
        "next": "start.3"
    },
    "start.3": {
        "type": "text",
        "text": "You enter the fletcher’s shop. The fletcher beckons, “There are arrows for sale and a range out back to try your skill and fortune. For each score hit, you win more gold!”",
        "lift": "",
        "drop": " ",
        "next": "start.4"
    },
    "start.4": {
        "type": "paragraph",
        "next": "shop"
    },
    "shop": {
        "type": "text",
        "text": "You have",
        "lift": "",
        "drop": " ",
        "next": "shop.1"
    },
    "shop.1": {
        "type": "switch",
        "expression": [
            "get",
            "arrow"
        ],
        "value": 0,
        "mode": "walk",
        "branches": [
            "shop.1.1",
            "shop.1.2",
            "shop.1.3"
        ]
    },
    "shop.1.1": {
        "type": "text",
        "text": "no arrows",
        "lift": "",
        "drop": "",
        "next": "shop.2"
    },
    "shop.1.2": {
        "type": "text",
        "text": "an arrow",
        "lift": "",
        "drop": "",
        "next": "shop.2"
    },
    "shop.1.3": {
        "type": "print",
        "expression": [
            "get",
            "arrow"
        ],
        "next": "shop.1.3.1"
    },
    "shop.1.3.1": {
        "type": "text",
        "text": "arrows",
        "lift": " ",
        "drop": "",
        "next": "shop.2"
    },
    "shop.2": {
        "type": "switch",
        "expression": [
            "get",
            "arrow"
        ],
        "value": 0,
        "mode": "walk",
        "branches": [
            "shop.2.1",
            "shop.2.2"
        ]
    },
    "shop.2.1": {
        "type": "switch",
        "expression": [
            "get",
            "gold"
        ],
        "value": 0,
        "mode": "walk",
        "branches": [
            "shop.2.1.0.1",
            "shop.2.1.0.2"
        ]
    },
    "shop.2.1.0.1": {
        "type": "text",
        "text": "and",
        "lift": " ",
        "drop": " ",
        "next": "shop.3"
    },
    "shop.2.1.0.2": {
        "type": "text",
        "text": "but",
        "lift": " ",
        "drop": " ",
        "next": "shop.3"
    },
    "shop.2.2": {
        "type": "text",
        "text": "and",
        "lift": " ",
        "drop": " ",
        "next": "shop.3"
    },
    "shop.3": {
        "type": "call",
        "label": "gold",
        "branch": "gold",
        "next": "shop.4"
    },
    "shop.4": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "shop.5"
    },
    "shop.5": {
        "type": "jump",
        "condition": [
            "==",
            [
                "get",
                "gold"
            ],
            [
                "val",
                0
            ]
        ],
        "branch": "shop.8",
        "next": "shop.6"
    },
    "shop.6": {
        "type": "jump",
        "condition": [
            "==",
            [
                "get",
                "arrow"
            ],
            [
                "val",
                0
            ]
        ],
        "branch": "shop.8",
        "next": "exit"
    },
    "shop.8": {
        "type": "jump",
        "condition": [
            "!=",
            [
                "get",
                "gold"
            ],
            [
                "val",
                0
            ]
        ],
        "branch": "shop.10",
        "next": "shop.9"
    },
    "shop.9": {
        "type": "option",
        "label": "Buy 3 arrows for a gold piece.",
        "keywords": [],
        "branch": "shop.9.1",
        "next": "shop.10"
    },
    "shop.9.1": {
        "type": "text",
        "text": "You b",
        "lift": "",
        "drop": "",
        "next": "shop.9.2"
    },
    "shop.9.2": {
        "type": "text",
        "text": "uy 3 arrows for a gold piece.",
        "lift": "",
        "drop": " ",
        "next": "shop.9.3"
    },
    "shop.9.3": {
        "type": "set",
        "variable": "gold",
        "expression": [
            "-",
            [
                "get",
                "gold"
            ],
            [
                "val",
                1
            ]
        ],
        "next": "shop.9.4"
    },
    "shop.9.4": {
        "type": "set",
        "variable": "arrow",
        "expression": [
            "+",
            [
                "get",
                "arrow"
            ],
            [
                "val",
                3
            ]
        ],
        "next": "shop"
    },
    "shop.10": {
        "type": "jump",
        "condition": [
            ">=",
            [
                "get",
                "arrow"
            ],
            [
                "val",
                4
            ]
        ],
        "branch": "shop.12",
        "next": "shop.11"
    },
    "shop.11": {
        "type": "option",
        "label": "Sell 4 arrows for a gold piece.",
        "keywords": [],
        "branch": "shop.11.1",
        "next": "shop.12"
    },
    "shop.11.1": {
        "type": "text",
        "text": "You s",
        "lift": "",
        "drop": "",
        "next": "shop.11.2"
    },
    "shop.11.2": {
        "type": "text",
        "text": "ell 4 arrows for a gold piece.",
        "lift": "",
        "drop": " ",
        "next": "shop.11.3"
    },
    "shop.11.3": {
        "type": "set",
        "variable": "gold",
        "expression": [
            "+",
            [
                "get",
                "gold"
            ],
            [
                "val",
                1
            ]
        ],
        "next": "shop.11.4"
    },
    "shop.11.4": {
        "type": "set",
        "variable": "arrow",
        "expression": [
            "-",
            [
                "get",
                "arrow"
            ],
            [
                "val",
                4
            ]
        ],
        "next": "shop"
    },
    "shop.12": {
        "type": "option",
        "label": "Visit the archery range.",
        "keywords": [],
        "branch": "shop.12.1",
        "next": "shop.13"
    },
    "shop.12.1": {
        "type": "text",
        "text": "You walk through the door to",
        "lift": "",
        "drop": "",
        "next": "shop.12.2"
    },
    "shop.12.2": {
        "type": "text",
        "text": "the archery range.",
        "lift": " ",
        "drop": " ",
        "next": "range"
    },
    "shop.13": {
        "type": "option",
        "label": "Leave the store",
        "keywords": [],
        "branch": "exit",
        "next": "shop.14"
    },
    "shop.14": {
        "type": "prompt"
    },
    "range": {
        "type": "text",
        "text": "You have",
        "lift": "",
        "drop": " ",
        "next": "range.1"
    },
    "range.1": {
        "type": "switch",
        "expression": [
            "get",
            "arrow"
        ],
        "value": 0,
        "mode": "walk",
        "branches": [
            "range.1.1",
            "range.1.2",
            "range.1.3"
        ]
    },
    "range.1.1": {
        "type": "text",
        "text": "no arrows",
        "lift": "",
        "drop": "",
        "next": "range.2"
    },
    "range.1.2": {
        "type": "text",
        "text": "an arrow",
        "lift": "",
        "drop": "",
        "next": "range.2"
    },
    "range.1.3": {
        "type": "print",
        "expression": [
            "get",
            "arrow"
        ],
        "next": "range.1.3.1"
    },
    "range.1.3.1": {
        "type": "text",
        "text": "arrows",
        "lift": " ",
        "drop": "",
        "next": "range.2"
    },
    "range.2": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "range.3"
    },
    "range.3": {
        "type": "jump",
        "condition": [
            "!=",
            [
                "get",
                "arrow"
            ],
            [
                "val",
                0
            ]
        ],
        "branch": "range.5",
        "next": "range.4"
    },
    "range.4": {
        "type": "option",
        "label": "Shoot an arrow",
        "keywords": [],
        "branch": "range.4.1",
        "next": "range.5"
    },
    "range.4.1": {
        "type": "text",
        "text": "You s",
        "lift": "",
        "drop": "",
        "next": "range.4.2"
    },
    "range.4.2": {
        "type": "text",
        "text": "hoot an arrow",
        "lift": "",
        "drop": " ",
        "next": "range.4.3"
    },
    "range.4.3": {
        "type": "set",
        "variable": "arrow",
        "expression": [
            "-",
            [
                "get",
                "arrow"
            ],
            [
                "val",
                1
            ]
        ],
        "next": "range.4.4"
    },
    "range.4.4": {
        "type": "switch",
        "expression": [
            "get",
            "range.4.4"
        ],
        "value": 0,
        "mode": "rand",
        "branches": [
            "range.4.4.1",
            "range.4.4.2",
            "range.4.4.3"
        ]
    },
    "range.4.4.1": {
        "type": "text",
        "text": "and hit the target, winning 1 gold piece!",
        "lift": "",
        "drop": " ",
        "next": "range.4.4.1.1"
    },
    "range.4.4.1.1": {
        "type": "set",
        "variable": "gold",
        "expression": [
            "+",
            [
                "get",
                "gold"
            ],
            [
                "val",
                1
            ]
        ],
        "next": "range.4.4.1.2"
    },
    "range.4.4.1.2": {
        "type": "set",
        "variable": "hit",
        "expression": [
            "+",
            [
                "get",
                "hit"
            ],
            [
                "val",
                1
            ]
        ],
        "next": "range"
    },
    "range.4.4.2": {
        "type": "goto",
        "next": "range.4.5"
    },
    "range.4.4.3": {
        "type": "goto",
        "next": "range.4.5"
    },
    "range.4.5": {
        "type": "text",
        "text": "and miss.",
        "lift": " ",
        "drop": " ",
        "next": "range"
    },
    "range.5": {
        "type": "option",
        "label": "Return to the archery shop.",
        "keywords": [],
        "branch": "range.5.1",
        "next": "range.6"
    },
    "range.5.1": {
        "type": "text",
        "text": "You r",
        "lift": "",
        "drop": "",
        "next": "range.5.2"
    },
    "range.5.2": {
        "type": "text",
        "text": "eturn to the archery shop.",
        "lift": "",
        "drop": " ",
        "next": "shop"
    },
    "range.6": {
        "type": "prompt"
    },
    "gold": {
        "type": "subroutine",
        "locals": [],
        "next": "gold.1"
    },
    "gold.1": {
        "type": "switch",
        "expression": [
            "get",
            "gold"
        ],
        "value": 0,
        "mode": "walk",
        "branches": [
            "gold.1.1",
            "gold.1.2",
            "gold.1.3"
        ]
    },
    "gold.1.1": {
        "type": "text",
        "text": "no gold",
        "lift": "",
        "drop": "",
        "next": null
    },
    "gold.1.2": {
        "type": "text",
        "text": "a gold piece",
        "lift": "",
        "drop": "",
        "next": null
    },
    "gold.1.3": {
        "type": "print",
        "expression": [
            "get",
            "gold"
        ],
        "next": "gold.1.3.1"
    },
    "gold.1.3.1": {
        "type": "text",
        "text": "gold",
        "lift": " ",
        "drop": "",
        "next": null
    },
    "exit": {
        "type": "text",
        "text": "You depart the store through the back door with",
        "lift": " ",
        "drop": " ",
        "next": "exit.1"
    },
    "exit.1": {
        "type": "call",
        "label": "gold",
        "branch": "gold",
        "next": "exit.2"
    },
    "exit.2": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "exit.3"
    },
    "exit.3": {
        "type": "jump",
        "condition": [
            "!=",
            [
                "get",
                "hit"
            ],
            [
                "val",
                0
            ]
        ],
        "branch": null,
        "next": "exit.4"
    },
    "exit.4": {
        "type": "text",
        "text": "All told, you scored",
        "lift": " ",
        "drop": " ",
        "next": "exit.5"
    },
    "exit.5": {
        "type": "print",
        "expression": [
            "get",
            "hit"
        ],
        "next": "exit.6"
    },
    "exit.6": {
        "type": "text",
        "text": "hit",
        "lift": " ",
        "drop": "",
        "next": "exit.7"
    },
    "exit.7": {
        "type": "switch",
        "expression": [
            "get",
            "hit"
        ],
        "value": 0,
        "mode": "walk",
        "branches": [
            "exit.7.1",
            "exit.7.2",
            "exit.7.3"
        ]
    },
    "exit.7.1": {
        "type": "text",
        "text": "s",
        "lift": "",
        "drop": "",
        "next": "exit.8"
    },
    "exit.7.2": {
        "type": "goto",
        "next": "exit.8"
    },
    "exit.7.3": {
        "type": "text",
        "text": "s",
        "lift": "",
        "drop": "",
        "next": "exit.8"
    },
    "exit.8": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": null
    }
}
